<!DOCTYPE html>
<html>
    <head>
        <title>Blue Voter Guide address autocompletion demo</title>
    </head>
    <body>
        <label for="addr">Address:</label>
        <input
            size="50"
            type="text"
            id="addr"
            autocomplete="off"
            list="addr-suggestions"
        />
        <datalist id="addr-suggestions"> </datalist>
        <script type="text/javascript" src="./main.js"></script>
        <script>
            const suggestionList = document.getElementById("addr-suggestions");
            const loadSuggestions = (element) => {
                // console.log("loading suggestions...");
                const text = element.value;
                if (text === '') {
                    suggestionList.replaceChildren();
                    return;
                }
                getAddressAutocompleteSuggestions(text).then((suggestions) => {
                    // console.log("Suggestions:");
                    // console.dir(suggestions);
                    var options = [];
                    if (suggestions && suggestions.length > 0) {
                        options = suggestions.map((suggestion) => {
                            const option = document.createElement("option");
                            option.value = suggestion;
                            return option;
                        });
                    }
                    suggestionList.replaceChildren(...options);
                });
            };
            const addrField = document.getElementById("addr");
            addrField.addEventListener("input", (event) => {
                loadSuggestions(event.target);
            });
        </script>
    </body>
</html>
